\documentclass[a4paper,12pt, openany]{book}  % Book class for thesis 
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{graphicx}
\usepackage{geometry}
\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm} 
\usepackage{setspace}
\setstretch{1}
\raggedbottom
\usepackage{titlesec}
\usepackage[toc,page]{appendix}
\titleformat{\subsection}[hang]{\normalfont\large\bfseries}{\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{\baselineskip}{0.5\baselineskip}
\usepackage[bottom]{footmisc}
\usepackage{ragged2e}
\usepackage{ltablex}
\usepackage[shortlabels]{enumitem}
\keepXColumns
\renewcommand\tabularxcolumn[1]{>{\noindent\justifying\arraybackslash}m{#1}}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{pifont}%
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\usepackage{lmodern}
\usepackage{fancyhdr}
\usepackage{tocloft}
\usepackage{xcolor}
\usepackage[
    colorlinks=true,        % disables boxes around links
    urlcolor=teal,          % URL link color
    linkcolor=black,        % color of internal links (e.g., TOC)
    citecolor=blue
]{hyperref}
\usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, positioning}
\usepackage{adjustbox}
\usepackage[nameinlink,noabbrev]{cleveref}
\usepackage{array}
\usepackage[nottoc]{tocbibind}
\usepackage{booktabs}
\usepackage{float}
\usepackage[T1]{fontenc}
\usepackage{soul}  
\usepackage[font=bf,labelfont=bf,justification=raggedright,singlelinecheck=false]{caption}

\captionsetup{font={bf,small}, labelfont=bf, justification=raggedright, singlelinecheck=false}

\usepackage{chngcntr}
\counterwithout{footnote}{chapter}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage{tikz}
\usetikzlibrary{shapes, arrows, positioning, calc, fit, shapes.geometric, arrows.meta, decorations.pathreplacing, patterns}
\usepackage{pgfplots}
\usepackage{fvextra}
\lstset{
  breaklines=true,
  basicstyle=\ttfamily\small,
  frame=single
}

\usepackage{multirow, tabularx, xurl}

\usepackage[authordate,backend=biber,natbib]{biblatex-chicago}
\ExecuteBibliographyOptions{maxcitenames=2, mincitenames=1}
\DeclareDelimFormat{nameyeardelim}{\addcomma\space}
\addbibresource{references.bib}
\AtEveryCitekey{%
  \ifciteseen
    {}
    {\color{blue}}%
}
\renewbibmacro*{doi+eprint+url}{
  \printfield{doi}
}
\DeclareCiteCommand{\citep}
  {\begingroup(}  % Start a group, manually insert black opening parenthesis
  {\color{blue}\usebibmacro{citeindex}%
   \usebibmacro{cite}}
  {\multicitedelim}
  {\usebibmacro{postnote}\endgroup)}  % Close blue group, then black parenthesis
\DeclareFieldFormat{doi}{%
  DOI: \ifhyperref
    {\href{https://doi.org/#1}{#1}}
    {#1}}

% Page numbering setup (BOTTOM CENTER)
\pagestyle{fancy}
\fancyhf{} % Clear all headers and footers
\renewcommand{\headrulewidth}{0pt} % Remove header line
\fancyfoot[C]{\thepage} % Center page number in footer

% Apply same style to chapter start pages
\fancypagestyle{plain}{%
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \fancyfoot[C]{\thepage}
}

% Chapter formatting
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}
  {\chaptertitlename\ \thechapter}{20pt}{\Huge} 

\titlespacing*{\subsubsection}{2em}{*0}{*0}


% Customize Table of Contents
\setlength{\cftbeforetoctitleskip}{-1em} % Reduce space before title
\setlength{\cftaftertoctitleskip}{1.5em} % Space after title
\setlength{\cftbeforetoctitleskip}{50pt} % Space above TOC title (same as chapters)
\renewcommand{\cftchappagefont}{\normalfont} % Page numbers normal
\renewcommand{\cftchapdotsep}{\cftdotsep} % Add dot leaders
\setlength{\cftbeforesecskip}{0.5ex} % Reduce space between sections
% Add List of Figures/Tables to TOC
\renewcommand{\listfigurename}{List of Figures}
\renewcommand{\listtablename}{List of Tables}
\renewcommand{\lstlistlistingname}{List of Code Examples}

\usepackage{etoolbox}
\pretocmd{\lstlistoflistings}{%
  \addcontentsline{toc}{chapter}{\lstlistlistingname}%
}{}{}

\usepackage{pdfcomment}
\begin{document}

% Frontispiece
\begin{titlepage}
    \centering
    \includegraphics[width=0.2\textwidth]{images/unibo-logo.pdf}
    
    \vspace*{1cm}
    \Large
    \textbf{ALMA MATER STUDIORUM \\ 
    UNIVERSITÃ€ DI BOLOGNA}
    
    
    \vspace{1.5cm}
    
    \normalsize
    \textsc{Department of Classical Philology and Italian Studies} \\
    \vspace{0.5cm}
    \textsc{Second Cycle Degree in} \\
    \vspace{0.2cm}
    \textsc{\textbf{Digital Humanities and Digital Knowledge}}
    
    \vspace{1.6cm}
    
    \begin{spacing}{1}
    \LARGE
    \textbf{From Documents to Dialogue:\\Design, Implementation and Evaluation of a Question-Answering System for Geoportale Nazionale Archeologia}
    \end{spacing}
    
    \vspace{1.2cm}
    \normalsize
    Dissertation in\\
    \textbf{Machine Learning for the Arts and Humanities}
    
    \vspace{1cm}
    
    \begin{tabbing}
    \textbf{Supervisor} \hspace{10cm} \= \textbf{Defended by} \\
    Prof. Giovanni Colavizza \> Lucrezia Pograri \\
    \\
    \textbf{Co-Supervisors}\\
    Prof. Paolo Bonora \\
    Mario Caruso and Simone Persiani, BUP Solutions
    \end{tabbing}
    
    \vfill
    \rule{\linewidth}{0.4pt}
    \vspace{0.2cm}
    
    \textbf{Graduation Session II} \\
    \textbf{Academic Year 2024/2025}
    
\end{titlepage}
\newpage
\thispagestyle{empty}  % Force blank page to have no header/footer
\mbox{}                % Prevent "empty page" warning
\setcounter{figure}{0}

%\pagestyle{empty}
% Front Matter (Roman page numbering)
\frontmatter
\pagestyle{fancy}
\tableofcontents

% Abstract
\input{chapters/abstract}
\clearpage
\input{chapters/acknowledgments.tex}
\clearpage
\listoffigures
\clearpage
\listoftables
\clearpage
\lstlistoflistings
\clearpage

\newpage
\thispagestyle{empty} 
\mbox{}                

% Main Content (Arabic page numbering)
\mainmatter
\pagestyle{fancy}
\renewcommand{\figureautorefname}{Fig.}
\renewcommand{\tableautorefname}{Tab.}
\renewcommand{\chapterautorefname}{Chap.}
\renewcommand{\sectionautorefname}{Sec.}
\renewcommand{\subsectionautorefname}{Sec.}
\makeatletter
\renewcommand{\thefootnote}{\textsuperscript{\arabic{footnote}}}
\renewcommand\@makefntext[1]{%
  \noindent
  \parindent=0pt
  \leftskip=0pt
  \hb@xt@1.8em{\hss\@thefnmark}#1%
}
\makeatother

\input{chapters/introduction}
\input{chapters/QAS}
\input{chapters/SOTA}
\input{chapters/casestudy}
\input{chapters/methodology}
\input{chapters/results}
\input{chapters/discussion}
\input{chapters/conclusion}

\clearpage
% Appendices
\begin{appendices}
    \chapter{Implementation details}
    \label{appendix:A}

In this study, all the experiments have been executed in Python 3.11.9 on a system equipped with an Intel Core i7-1185G7 CPU at 3.00 GHz, 16 GB of RAM, and integrated Intel Iris Xe Graphics with 128 MB of VRAM.\\ 


\noindent The ablation studies were conducted on the \textit{singlehop} dataset, comprising 508 queries, and on the \textit{combined} dataset, comprising 908 queries in total (singlehop plus multi-hop questions). The retrieval index, implemented using FAISS, contained 801 document chunks with a length of 687 words (average: 91.83 words). Evaluation was carried out in batch mode with a batch size of 32, retrieving up to \texttt{candidate\_k} = 50 documents per query before applying top-$k$ selection ($k$ = 5). For hybrid retrieval configurations, the RRF parameter was set to $k$ = 60, with dense and sparse weights both equal to 1.0, while $\alpha$ = 0.3.\\

\noindent Additionally, the proposed approach was implemented using the following libraries: PyTorch, Hugging Face Transformers, SentenceTransformers, PEFT, spaCy, KeyBERT, NLTK, FAISS, Rank-BM25, and scikit-learn. These were complemented by supporting and utility packages such as NumPy, Pandas, Matplotlib, Streamlit, Pillow (PIL), BeautifulSoup (bs4), httpx, and the MistralAI API, as well as standard Python libraries including asyncio, concurrent.futures, collections, functools, and urllib.

\input{chapters/appendixB.tex}


\end{appendices}

\sloppy
% Back Matter
\backmatter
\pagestyle{fancy}

\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}
\printbibliography

\end{document}